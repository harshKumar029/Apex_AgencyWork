import React, { useRef, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import DashboardIcon from "../assets/icon/SidebarIcon/Dashboard.svg";
import Documents from "../assets/icon/SidebarIcon/Documents.svg";
import Earning from "../assets/icon/SidebarIcon/Earning.svg";
import Language from "../assets/icon/SidebarIcon/Language.svg";
import Leads from "../assets/icon/SidebarIcon/Leads.svg";
import LogoutIcon from "../assets/icon/SidebarIcon/Logout.svg";
import MyLevel from "../assets/icon/SidebarIcon/MyLevel.svg";
import Mywebsite from "../assets/icon/SidebarIcon/Mywebsite.svg";
import Paymentdetail from "../assets/icon/SidebarIcon/Paymentdetail.svg";
import Setting from "../assets/icon/SidebarIcon/setting.svg";
import Support from "../assets/icon/SidebarIcon/Support.svg";
import Team from "../assets/icon/SidebarIcon/Team.svg";
import Tearm_Condition from "../assets/icon/SidebarIcon/Tearm&Condition.svg";
import Training from "../assets/icon/SidebarIcon/Training.svg";
import ApexLogo from "../assets/icon/SidebarIcon/ApexLogo.svg";
import Share from "../assets/icon/SidebarIcon/Share.svg";
import { useSidebar } from "../ContextApi";

// Firebase imports
import { signOut } from "firebase/auth";
import { auth } from "../firebase";

const SideBar = () => {
  const navigate = useNavigate();
  const { isOpen, setIsOpen, setIsOpenProfile } = useSidebar();
  const sidebarRef = useRef(null);

  const menuItems = [
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 25 25"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M24.3254 10.8738C24.3248 10.8732 24.3243 10.8727 24.3237 10.8721L14.1257 0.674438C13.691 0.239563 13.1131 0 12.4983 0C11.8836 0 11.3057 0.239372 10.8708 0.674248L0.678111 10.8667C0.674678 10.8702 0.671244 10.8738 0.667811 10.8772C-0.224828 11.775 -0.223302 13.2317 0.672198 14.1272C1.08132 14.5365 1.62168 14.7736 2.19941 14.7984C2.22287 14.8006 2.24652 14.8018 2.27037 14.8018H2.67682V22.3066C2.67682 23.7917 3.88513 25 5.37057 25H9.36036C9.76472 25 10.0928 24.6721 10.0928 24.2676V18.3838C10.0928 17.7061 10.644 17.1549 11.3217 17.1549H13.675C14.3527 17.1549 14.9039 17.7061 14.9039 18.3838V24.2676C14.9039 24.6721 15.2318 25 15.6363 25H19.6261C21.1115 25 22.3198 23.7917 22.3198 22.3066V14.8018H22.6967C23.3113 14.8018 23.8892 14.5624 24.3243 14.1275C25.2207 13.2305 25.2211 11.7714 24.3254 10.8738Z"
            fill="currentColor"
          />
        </svg>
      ),
      label: "Dashboard",
      path: "/dashboard",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 25 25"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clip-path="url(#clip0_601_1520)">
            <path
              d="M4.42706 4.16699C3.80546 4.16699 3.20932 4.41392 2.76978 4.85346C2.33024 5.293 2.08331 5.88914 2.08331 6.51074V9.11491C2.08331 9.73651 2.33024 10.3327 2.76978 10.7722C3.20932 11.2117 3.80546 11.4587 4.42706 11.4587H7.03123C7.65283 11.4587 8.24897 11.2117 8.68851 10.7722C9.12805 10.3327 9.37498 9.73651 9.37498 9.11491V6.51074C9.37498 5.88914 9.12805 5.293 8.68851 4.85346C8.24897 4.41392 7.65283 4.16699 7.03123 4.16699H4.42706ZM11.7187 5.20866C11.5115 5.20866 11.3128 5.29097 11.1663 5.43748C11.0198 5.58399 10.9375 5.78271 10.9375 5.98991C10.9375 6.19711 11.0198 6.39582 11.1663 6.54234C11.3128 6.68885 11.5115 6.77116 11.7187 6.77116H22.1354C22.3426 6.77116 22.5413 6.68885 22.6878 6.54234C22.8343 6.39582 22.9166 6.19711 22.9166 5.98991C22.9166 5.78271 22.8343 5.58399 22.6878 5.43748C22.5413 5.29097 22.3426 5.20866 22.1354 5.20866H11.7187ZM11.7187 8.33366C11.5115 8.33366 11.3128 8.41597 11.1663 8.56248C11.0198 8.70899 10.9375 8.90771 10.9375 9.11491C10.9375 9.32211 11.0198 9.52082 11.1663 9.66734C11.3128 9.81385 11.5115 9.89616 11.7187 9.89616H19.0104C19.2176 9.89616 19.4163 9.81385 19.5628 9.66734C19.7093 9.52082 19.7916 9.32211 19.7916 9.11491C19.7916 8.90771 19.7093 8.70899 19.5628 8.56248C19.4163 8.41597 19.2176 8.33366 19.0104 8.33366H11.7187ZM4.42706 13.542C3.80546 13.542 3.20932 13.7889 2.76978 14.2285C2.33024 14.668 2.08331 15.2641 2.08331 15.8857V18.4899C2.08331 18.7977 2.14394 19.1025 2.26172 19.3868C2.3795 19.6712 2.55214 19.9296 2.76978 20.1472C2.98742 20.3648 3.24579 20.5375 3.53015 20.6553C3.81451 20.773 4.11928 20.8337 4.42706 20.8337H7.03123C7.33902 20.8337 7.64379 20.773 7.92814 20.6553C8.2125 20.5375 8.47087 20.3648 8.68851 20.1472C8.90615 19.9296 9.07879 19.6712 9.19657 19.3868C9.31436 19.1025 9.37498 18.7977 9.37498 18.4899V15.8857C9.37498 15.2641 9.12805 14.668 8.68851 14.2285C8.24897 13.7889 7.65283 13.542 7.03123 13.542H4.42706ZM11.7187 14.5837C11.5115 14.5837 11.3128 14.666 11.1663 14.8125C11.0198 14.959 10.9375 15.1577 10.9375 15.3649C10.9375 15.5721 11.0198 15.7708 11.1663 15.9173C11.3128 16.0638 11.5115 16.1462 11.7187 16.1462H22.1354C22.3426 16.1462 22.5413 16.0638 22.6878 15.9173C22.8343 15.7708 22.9166 15.5721 22.9166 15.3649C22.9166 15.1577 22.8343 14.959 22.6878 14.8125C22.5413 14.666 22.3426 14.5837 22.1354 14.5837H11.7187ZM11.7187 17.7087C11.5115 17.7087 11.3128 17.791 11.1663 17.9375C11.0198 18.084 10.9375 18.2827 10.9375 18.4899C10.9375 18.6971 11.0198 18.8958 11.1663 19.0423C11.3128 19.1888 11.5115 19.2712 11.7187 19.2712H19.0104C19.2176 19.2712 19.4163 19.1888 19.5628 19.0423C19.7093 18.8958 19.7916 18.6971 19.7916 18.4899C19.7916 18.2827 19.7093 18.084 19.5628 17.9375C19.4163 17.791 19.2176 17.7087 19.0104 17.7087H11.7187Z"
              fill="currentColor"
            />
          </g>
          <defs>
            <clipPath id="clip0_601_1520">
              <rect width="25" height="25" fill="white" />
            </clipPath>
          </defs>
        </svg>
      ),
      label: "My Leads",
      path: "/my-leads",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 25 25"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M5.20831 22.9168C5.20897 23.4692 5.42867 23.9987 5.81923 24.3892C6.20979 24.7798 6.73931 24.9995 7.29165 25.0002H17.7083C18.2606 24.9995 18.7902 24.7798 19.1807 24.3892C19.5713 23.9987 19.791 23.4692 19.7916 22.9168V22.0054H5.20831V22.9168Z"
            fill="currentColor"
          />
          <path
            d="M19.7916 2.08333C19.791 1.531 19.5713 1.00148 19.1807 0.610917C18.7902 0.220358 18.2606 0.00065473 17.7083 0L7.29165 0C6.73931 0.00065473 6.20979 0.220358 5.81923 0.610917C5.42867 1.00148 5.20897 1.531 5.20831 2.08333V3.125H19.7916V2.08333Z"
            fill="currentColor"
          />
          <path
            d="M24.7097 6.70052L21.5847 3.44531L20.0819 4.88802L21.3893 6.25H19.7916V8.33333H21.5017L20.1126 9.66459L21.554 11.1688L24.679 8.17396C24.7778 8.07926 24.857 7.96602 24.912 7.8407C24.9671 7.71538 24.9968 7.58045 24.9997 7.44361C25.0026 7.30677 24.9784 7.17071 24.9287 7.04321C24.8789 6.91571 24.8045 6.79926 24.7097 6.70052Z"
            fill="currentColor"
          />
          <path
            d="M16.6666 6.24984H19.7916V4.1665H5.20831V16.6665H8.33331V18.7498H5.20831V20.8332H19.7916V8.33317H16.6666V6.24984ZM15.625 10.4165H11.9791C11.841 10.4165 11.7085 10.4714 11.6109 10.5691C11.5132 10.6667 11.4583 10.7992 11.4583 10.9373C11.4583 11.0755 11.5132 11.2079 11.6109 11.3056C11.7085 11.4033 11.841 11.4582 11.9791 11.4582H13.0208C13.6666 11.4575 14.2896 11.6969 14.7689 12.1297C15.2482 12.5626 15.5495 13.1581 15.6144 13.8006C15.6793 14.4432 15.5032 15.0869 15.1201 15.6069C14.7371 16.1268 14.1745 16.4859 13.5416 16.6144V17.7082H11.4583V16.6665H9.37498V14.5832H13.0208C13.1589 14.5832 13.2914 14.5283 13.3891 14.4306C13.4868 14.3329 13.5416 14.2005 13.5416 14.0623C13.5416 13.9242 13.4868 13.7917 13.3891 13.6941C13.2914 13.5964 13.1589 13.5415 13.0208 13.5415H11.9791C11.3333 13.5422 10.7103 13.3028 10.2311 12.87C9.75179 12.4371 9.45045 11.8416 9.38555 11.1991C9.32064 10.5565 9.4968 9.91278 9.87983 9.39282C10.2629 8.87286 10.8254 8.51377 11.4583 8.38525V7.2915H13.5416V8.33317H15.625V10.4165Z"
            fill="currentColor"
          />
          <path
            d="M3.49828 16.6665L4.88734 15.3352L3.44593 13.8311L0.320931 16.8258C0.222115 16.9205 0.142929 17.0338 0.0879011 17.1591C0.0328728 17.2844 0.00308028 17.4194 0.000226477 17.5562C-0.00262733 17.693 0.0215135 17.8291 0.0712692 17.9566C0.121025 18.0841 0.19542 18.2005 0.290202 18.2993L3.4152 21.5545L4.91807 20.1118L3.61064 18.7498H5.2083V16.6665H3.49828Z"
            fill="currentColor"
          />
        </svg>
      ),
      label: "Payment Detail",
      path: "/paymentdetail",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 25 25"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M4.375 5C3.87772 5 3.40081 5.19754 3.04917 5.54917C2.69754 5.90081 2.5 6.37772 2.5 6.875V15.625C2.5 16.1223 2.69754 16.5992 3.04917 16.9508C3.40081 17.3025 3.87772 17.5 4.375 17.5H18.125C18.6223 17.5 19.0992 17.3025 19.4508 16.9508C19.8025 16.5992 20 16.1223 20 15.625V6.875C20 6.37772 19.8025 5.90081 19.4508 5.54917C19.0992 5.19754 18.6223 5 18.125 5H4.375ZM7.5 6.25V7.5C7.5 8.16304 7.23661 8.79893 6.76777 9.26777C6.29893 9.73661 5.66304 10 5 10H3.75V8.75H5C5.33152 8.75 5.64946 8.6183 5.88388 8.38388C6.1183 8.14946 6.25 7.83152 6.25 7.5V6.25H7.5ZM11.25 13.4375C10.6698 13.4375 10.1134 13.207 9.7032 12.7968C9.29297 12.3866 9.0625 11.8302 9.0625 11.25C9.0625 10.6698 9.29297 10.1134 9.7032 9.7032C10.1134 9.29297 10.6698 9.0625 11.25 9.0625C11.8302 9.0625 12.3866 9.29297 12.7968 9.7032C13.207 10.1134 13.4375 10.6698 13.4375 11.25C13.4375 11.8302 13.207 12.3866 12.7968 12.7968C12.3866 13.207 11.8302 13.4375 11.25 13.4375ZM3.75 13.75V12.5H5C5.66304 12.5 6.29893 12.7634 6.76777 13.2322C7.23661 13.7011 7.5 14.337 7.5 15V16.25H6.25V15C6.25 14.6685 6.1183 14.3505 5.88388 14.1161C5.64946 13.8817 5.33152 13.75 5 13.75H3.75ZM17.5 13.75C17.1685 13.75 16.8505 13.8817 16.6161 14.1161C16.3817 14.3505 16.25 14.6685 16.25 15V16.25H15V15C15 14.337 15.2634 13.7011 15.7322 13.2322C16.2011 12.7634 16.837 12.5 17.5 12.5H18.75V13.75H17.5ZM17.5 8.75H18.75V10H17.5C16.837 10 16.2011 9.73661 15.7322 9.26777C15.2634 8.79893 15 8.16304 15 7.5V6.25H16.25V7.5C16.25 7.83152 16.3817 8.14946 16.6161 8.38388C16.8505 8.6183 17.1685 8.75 17.5 8.75ZM21.25 15.625C21.25 16.4538 20.9208 17.2487 20.3347 17.8347C19.7487 18.4208 18.9538 18.75 18.125 18.75H5.10625C5.23555 19.1157 5.4751 19.4323 5.79189 19.6562C6.10867 19.8801 6.48709 20.0002 6.875 20H18.125C19.2853 20 20.3981 19.5391 21.2186 18.7186C22.0391 17.8981 22.5 16.7853 22.5 15.625V9.375C22.5002 8.98709 22.3801 8.60867 22.1562 8.29189C21.9323 7.9751 21.6157 7.73555 21.25 7.60625V15.625Z"
            fill="currentColor"
          />
        </svg>
      ),
      label: "My Earning",
      path: "/earning",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 25 25"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4.34583 3.30433C3.125 4.52412 3.125 6.4887 3.125 10.4168V14.5835C3.125 18.5116 3.125 20.4762 4.34583 21.696C5.56667 22.9158 7.53021 22.9168 11.4583 22.9168H13.5417C17.4698 22.9168 19.4344 22.9168 20.6542 21.696C21.874 20.4752 21.875 18.5116 21.875 14.5835V10.4168C21.875 6.4887 21.875 4.52412 20.6542 3.30433C19.4333 2.08454 17.4698 2.0835 13.5417 2.0835H11.4583C7.53021 2.0835 5.56562 2.0835 4.34583 3.30433ZM8.33333 9.63558C8.12613 9.63558 7.92742 9.71789 7.78091 9.8644C7.63439 10.0109 7.55208 10.2096 7.55208 10.4168C7.55208 10.624 7.63439 10.8227 7.78091 10.9693C7.92742 11.1158 8.12613 11.1981 8.33333 11.1981H16.6667C16.8739 11.1981 17.0726 11.1158 17.2191 10.9693C17.3656 10.8227 17.4479 10.624 17.4479 10.4168C17.4479 10.2096 17.3656 10.0109 17.2191 9.8644C17.0726 9.71789 16.8739 9.63558 16.6667 9.63558H8.33333ZM8.33333 13.8022C8.12613 13.8022 7.92742 13.8846 7.78091 14.0311C7.63439 14.1776 7.55208 14.3763 7.55208 14.5835C7.55208 14.7907 7.63439 14.9894 7.78091 15.1359C7.92742 15.2824 8.12613 15.3647 8.33333 15.3647H13.5417C13.7489 15.3647 13.9476 15.2824 14.0941 15.1359C14.2406 14.9894 14.3229 14.7907 14.3229 14.5835C14.3229 14.3763 14.2406 14.1776 14.0941 14.0311C13.9476 13.8846 13.7489 13.8022 13.5417 13.8022H8.33333Z"
            fill="currentColor"
          />
        </svg>
      ),
      label: "My Documents",
      path: "/documents",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M15.5 13.5C15.5 15.5 13 17 13 18.5H11C11 17 8.5 15.5 8.5 13.5C8.5 11.57 10.07 10 12 10C13.93 10 15.5 11.57 15.5 13.5ZM13 19.5H11V21H13V19.5ZM19 13C19 14.68 18.41 16.21 17.42 17.42L18.84 18.84C19.6087 17.9426 20.1926 16.9022 20.5585 15.7787C20.9243 14.6551 21.0648 13.4704 20.9719 12.2924C20.879 11.1145 20.5545 9.96643 20.0171 8.9141C19.4797 7.86177 18.7398 6.92586 17.84 6.16L16.42 7.58C17.2251 8.23556 17.8742 9.06199 18.3205 9.99941C18.7667 10.9368 18.9988 11.9618 19 13ZM16 5L12 1V4C9.61305 4 7.32387 4.94821 5.63604 6.63604C3.94821 8.32387 3 10.6131 3 13C3 15.23 3.82 17.27 5.16 18.84L6.58 17.42C5.55595 16.1749 4.99731 14.6121 5 13C5 9.14 8.14 6 12 6V9L16 5Z"
            fill="currentColor"
          />
        </svg>
      ),
      label: "Training",
      path: "/training",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 20 20"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M10 12C8.4087 12 6.88258 11.3679 5.75736 10.2426C4.63214 9.11742 4 7.5913 4 6C4 4.4087 4.63214 2.88258 5.75736 1.75736C6.88258 0.632141 8.4087 0 10 0C11.5913 0 13.1174 0.632141 14.2426 1.75736C15.3679 2.88258 16 4.4087 16 6C16 7.5913 15.3679 9.11742 14.2426 10.2426C13.1174 11.3679 11.5913 12 10 12ZM10 9C10.7956 9 11.5587 8.68393 12.1213 8.12132C12.6839 7.55871 13 6.79565 13 6C13 5.20435 12.6839 4.44129 12.1213 3.87868C11.5587 3.31607 10.7956 3 10 3C9.20435 3 8.44129 3.31607 7.87868 3.87868C7.31607 4.44129 7 5.20435 7 6C7 6.79565 7.31607 7.55871 7.87868 8.12132C8.44129 8.68393 9.20435 9 10 9ZM14 11.75V20L10 16L6 20V11.75C7.17213 12.5714 8.56871 13.012 10 13.012C11.4313 13.012 12.8279 12.5714 14 11.75Z"
            fill="currentColor"
          />
        </svg>
      ),
      label: "My Level",
      path: "/my-level",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 25 25"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M12.5 18.125C11.8715 18.1251 11.266 17.8885 10.8041 17.4623C10.3422 17.0361 10.0578 16.4515 10.0075 15.825C8.34023 15.2348 6.93506 14.0746 6.04003 12.5492C5.145 11.0238 4.81765 9.23116 5.11578 7.48783C5.41391 5.74451 6.31834 4.16256 7.66943 3.02123C9.02051 1.8799 10.7314 1.25258 12.5 1.25C14.3811 1.24973 16.1937 1.95636 17.5782 3.22978C18.9628 4.5032 19.8182 6.25043 19.975 8.125C19.9802 8.20631 19.9685 8.28782 19.9405 8.36435C19.9125 8.44087 19.8689 8.51075 19.8125 8.56952C19.7561 8.6283 19.6881 8.6747 19.6127 8.70577C19.5374 8.73684 19.4565 8.7519 19.375 8.75C19.2076 8.7458 19.0477 8.67951 18.9264 8.564C18.8051 8.4485 18.7311 8.29203 18.7188 8.125C18.6074 7.01979 18.2036 5.96423 17.5487 5.06697C16.8939 4.1697 16.0118 3.46317 14.9932 3.02011C13.9746 2.57704 12.8563 2.41345 11.7534 2.54618C10.6506 2.67891 9.60304 3.10316 8.71863 3.77525C7.83423 4.44734 7.14493 5.34299 6.72169 6.37C6.29845 7.39701 6.15656 8.51826 6.31064 9.61832C6.46471 10.7184 6.90918 11.7575 7.59829 12.6287C8.28739 13.4999 9.19624 14.1717 10.2313 14.575C10.4196 14.1681 10.7139 13.8193 11.0833 13.5652C11.4528 13.3111 11.8838 13.161 12.3312 13.1307C12.7785 13.1004 13.2258 13.191 13.6262 13.393C14.0265 13.595 14.3651 13.9009 14.6066 14.2787C14.8481 14.6566 14.9835 15.0924 14.9986 15.5405C15.0138 15.9887 14.9081 16.4327 14.6927 16.8259C14.4773 17.2192 14.1601 17.5473 13.7743 17.7759C13.3886 18.0044 12.9484 18.125 12.5 18.125ZM6.26125 15H6.375C7.11295 15.7239 7.97333 16.3113 8.91625 16.735C9.19336 17.6493 9.80899 18.4234 10.6375 18.8992C11.4659 19.375 12.4448 19.5166 13.3741 19.2952C14.3035 19.0738 15.1133 18.506 15.6382 17.7078C16.1632 16.9095 16.3637 15.941 16.1987 15H18.75C19.413 15 20.0489 15.2634 20.5178 15.7322C20.9866 16.2011 21.25 16.837 21.25 17.5C21.25 19.6138 20.2087 21.2075 18.5812 22.2463C16.9788 23.2675 14.8188 23.75 12.5 23.75C10.1813 23.75 8.02125 23.2675 6.41875 22.2463C4.79125 21.2088 3.75 19.6125 3.75 17.5C3.75 16.1088 4.87875 15 6.26125 15ZM17.5 8.75C17.5003 9.5958 17.286 10.4278 16.8772 11.1683C16.4684 11.9087 15.8784 12.5334 15.1625 12.9838C14.8138 12.6324 14.3991 12.3535 13.9421 12.1632C13.4851 11.9729 12.995 11.8749 12.5 11.875C12.005 11.8749 11.5149 11.9729 11.0579 12.1632C10.6009 12.3535 10.1862 12.6324 9.8375 12.9838C8.88803 12.3867 8.16689 11.4877 7.79 10.4313C7.59773 9.89159 7.49964 9.32289 7.5 8.75C7.5 7.42392 8.02678 6.15215 8.96447 5.21447C9.90215 4.27678 11.1739 3.75 12.5 3.75C13.8261 3.75 15.0979 4.27678 16.0355 5.21447C16.9732 6.15215 17.5 7.42392 17.5 8.75Z"
            fill="currentColor"
          />
        </svg>
      ),
      label: "Support",
      path: "/support",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 25 25"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M14.8437 2.60417C14.8437 2.5351 14.8163 2.46886 14.7675 2.42002C14.7186 2.37119 14.6524 2.34375 14.5833 2.34375H7.29165C6.53191 2.34375 5.80329 2.64555 5.26608 3.18277C4.72887 3.71998 4.42706 4.4486 4.42706 5.20833V19.7917C4.42706 20.5514 4.72887 21.28 5.26608 21.8172C5.80329 22.3544 6.53191 22.6562 7.29165 22.6562H17.7083C18.468 22.6562 19.1967 22.3544 19.7339 21.8172C20.2711 21.28 20.5729 20.5514 20.5729 19.7917V9.52813C20.5729 9.45906 20.5455 9.39282 20.4966 9.34398C20.4478 9.29515 20.3815 9.26771 20.3125 9.26771H15.625C15.4178 9.26771 15.2191 9.1854 15.0726 9.03889C14.926 8.89237 14.8437 8.69366 14.8437 8.48646V2.60417ZM15.625 12.7604C15.8322 12.7604 16.0309 12.8427 16.1774 12.9892C16.3239 13.1358 16.4062 13.3345 16.4062 13.5417C16.4062 13.7489 16.3239 13.9476 16.1774 14.0941C16.0309 14.2406 15.8322 14.3229 15.625 14.3229H9.37498C9.16778 14.3229 8.96907 14.2406 8.82255 14.0941C8.67604 13.9476 8.59373 13.7489 8.59373 13.5417C8.59373 13.3345 8.67604 13.1358 8.82255 12.9892C8.96907 12.8427 9.16778 12.7604 9.37498 12.7604H15.625ZM15.625 16.9271C15.8322 16.9271 16.0309 17.0094 16.1774 17.1559C16.3239 17.3024 16.4062 17.5011 16.4062 17.7083C16.4062 17.9155 16.3239 18.1142 16.1774 18.2608C16.0309 18.4073 15.8322 18.4896 15.625 18.4896H9.37498C9.16778 18.4896 8.96907 18.4073 8.82255 18.2608C8.67604 18.1142 8.59373 17.9155 8.59373 17.7083C8.59373 17.5011 8.67604 17.3024 8.82255 17.1559C8.96907 17.0094 9.16778 16.9271 9.37498 16.9271H15.625Z"
            fill="currentColor"
          />
          <path
            d="M16.4062 2.94152C16.4062 2.74985 16.6073 2.62798 16.7563 2.74777C16.8826 2.84985 16.9948 2.9686 17.0927 3.10402L20.2313 7.47589C20.3021 7.5759 20.225 7.70506 20.1021 7.70506H16.6667C16.5976 7.70506 16.5314 7.67763 16.4825 7.62879C16.4337 7.57995 16.4062 7.51371 16.4062 7.44464V2.94152Z"
            fill="currentColor"
          />
        </svg>
      ),
      label: "Terms & Conditions",
      path: "/terms",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 25 25"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clip-path="url(#clip0_586_1397)">
            <path
              d="M22.6985 9.41406H22.1678C21.9954 8.87451 21.7778 8.35039 21.5172 7.84683L21.8931 7.47095C22.8045 6.56055 22.7801 5.10156 21.8934 4.21582L20.7845 3.10693C19.8993 2.22056 18.44 2.19487 17.5293 3.10659L17.1532 3.48276C16.6496 3.22222 16.1254 3.00464 15.5859 2.83223V2.30142C15.5859 1.03242 14.5535 0 13.2845 0H11.7155C10.4465 0 9.41406 1.03242 9.41406 2.30142V2.83223C8.87456 3.00459 8.35039 3.22217 7.84683 3.48276L7.471 3.10693C6.56216 2.19702 5.10293 2.21836 4.21592 3.10664L3.10688 4.21558C2.22056 5.10093 2.19492 6.56001 3.10659 7.4707L3.48276 7.84687C3.22217 8.35044 3.00464 8.87451 2.83223 9.41411H2.30146C1.03247 9.41406 0 10.4465 0 11.7155V13.2845C0 14.5535 1.03247 15.5859 2.30146 15.5859H2.83223C3.00464 16.1255 3.22217 16.6496 3.48276 17.1532L3.10688 17.5291C2.19551 18.4395 2.21992 19.8984 3.10659 20.7842L4.21553 21.8931C5.10073 22.7794 6.56001 22.8051 7.47065 21.8934L7.84683 21.5172C8.35039 21.7778 8.87456 21.9954 9.41406 22.1678V22.6986C9.41406 23.9676 10.4465 25 11.7155 25H13.2845C14.5535 25 15.586 23.9676 15.586 22.6986V22.1678C16.1255 21.9954 16.6497 21.7778 17.1532 21.5172L17.5291 21.8931C18.4379 22.803 19.8971 22.7816 20.7841 21.8934L21.8932 20.7844C22.7795 19.899 22.8051 18.4399 21.8935 17.5292L21.5173 17.1531C21.7779 16.6495 21.9954 16.1254 22.1678 15.5858H22.6986C23.9676 15.5858 25 14.5534 25 13.2844V11.7154C25 10.4465 23.9675 9.41406 22.6985 9.41406ZM12.5 17.9395C9.50064 17.9395 7.06055 15.4993 7.06055 12.5C7.06055 9.50068 9.50064 7.06055 12.5 7.06055C15.4994 7.06055 17.9395 9.50068 17.9395 12.5C17.9395 15.4993 15.4994 17.9395 12.5 17.9395Z"
              fill="currentColor"
            />
          </g>
          <defs>
            <clipPath id="clip0_586_1397">
              <rect width="25" height="25" fill="white" />
            </clipPath>
          </defs>
        </svg>
      ),
      label: "Setting",
      path: "/settings",
    },
    {
      icon: (
        <svg
          className=" w-4 h-4"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M9 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H9"
            stroke="#ADB5BD"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M16 17L21 12L16 7"
            stroke="#ADB5BD"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M21 12H9"
            stroke="#ADB5BD"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      ),
      label: "Logout",
      action: "logout",
    },
  ];

  const handleLogout = async () => {
    const confirmLogout = window.confirm("Are you sure you want to logout?");
    if (!confirmLogout) return;

    try {
      await signOut(auth);
      console.log("User signed out successfully");
      navigate("/login");
      setIsOpen(false); // Close the sidebar after logout
    } catch (error) {
      console.error("Error signing out:", error);
      alert("Failed to log out. Please try again.");
    }
  };

  const handleClickOutside = (event) => {
    if (sidebarRef.current && !sidebarRef.current.contains(event.target)) {
      setIsOpen(false);
    }
  };

  useEffect(() => {
    document.addEventListener("mousedown", handleClickOutside);
    return () => {
      document.removeEventListener("mousedown", handleClickOutside);
    };
  }, []);

  return (
    <div className="z-[1000]" onClick={() => setIsOpenProfile(false)}>
      {/* Overlay */}
      {isOpen && (
        <div
          className="fixed inset-0 bg-black bg-opacity-50 z-[999] transition-opacity duration-300"
          onClick={() => setIsOpen(false)}
        ></div>
      )}

      {/* Sidebar */}
      <div
        ref={sidebarRef}
        className={`fixed left-0 top-0 h-full md:w-[17%] w-64 bg-white border-r transition-transform duration-300 ease-in-out transform ${
          isOpen ? "translate-x-0" : "-translate-x-full"
        } md:translate-x-0 z-[1000]`}
      >
        <div className="border-r-[0.5px] border-[#DEE2E6] text-[#ADB5BD] h-full flex flex-col">
          <div className="w-fit mx-auto">
            <div className="flex justify-between ml-1 mt-4">
              <img className="w-16" src={ApexLogo} alt="ApexLogo" />
              <button
                className="md:hidden text-[#094052] bg-[#09405240] my-4 p-1 rounded-full"
                onClick={() => setIsOpen(false)}
              >
                {/* <svg
                  className="w-6"
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M20 12H4M4 12L10 18M4 12L10 6"
                    stroke="currentColor"
                    strokeWidth="2"
                    strokeLinecap="round"
                    strokeLinejoin="round"
                  />
                </svg> */}
                <svg className="w-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
 <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
 </svg>
              </button>
            </div>
            <div className="space-y-4">
              <ul className="menu-list max-w-fit mt-5">
                {menuItems.map((item, index) => (
                  <li
                    key={index}
                    className={`menu-item flex  items-center px-4 py-[.6rem] cursor-pointer transition-all ${
                      location.pathname === item.path
                        ? " rounded-md border-l-4 border-[#0084ff8e]  text-[#063E50] bg-[#ececec] font-semibold hover:font-semibold hover:text-[#063E50] hover:bg-[#ececec]"
                        : "  rounded-md  text-[#063e5073] hover:text-[#ffffff] font-medium hover:font-semibold  hover:bg-[#878787f0]"
                    }`}
                    onClick={() => {
                      if (item.action === "logout") {
                        handleLogout();
                      } else {
                        navigate(item.path);
                        setIsOpen(false); // Close the sidebar when an item is clicked
                      }
                    }}
                  >
                    <span>{item.icon}</span>
                    <span className=" ml-2  text-lg md:text-base">
                      {item.label}
                    </span>
                  </li>
                ))}
              </ul>
              <button
                onClick={() => navigate("/refer-earn")}
                className="flex items-center rounded-lg gap-1 px-3 py-2 bg-[#063E50] font-medium text-base hover:bg-[#055a6a] transition-colors"
              >
                <img src={Share} alt="Share" />
                Refer & Earn
              </button>
            </div>
          </div>
          <div className="mt-auto hidden lg:block">
            <hr className="border-t border-[#ADB5BD] mb-1" />
            <div className="w-fit mx-auto space-y-4 py-2">
              <p className="font-medium text-sm">Apex. All rights reserved</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default SideBar;
